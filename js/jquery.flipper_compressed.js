(function(a){a.fn.Flipper=function(l){var t={dimensions:null,alphabet:["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"," ",".","?","!","@","#",":",",",'"',"'","/",";","(",")","%","-","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],flipSpeed:50,fontSize:120,callback:function(){},align:"center",skipAnimationThreshold:5,lineDelay:500,textOffset:{h:0,v:0}};a.extend(t,l);var s=a(this);var d=0;var m=[];for(r=0;r<t.dimensions[1];r++){var n=jQuery('<div class="panel-row" />');s.append(n);m.push([]);for(c=0;c<t.dimensions[0];c++){var q=jQuery('<div class="flipper-container"><div class="pers-wrapper top"><div class="stationary-panel"><span></span></div><div class="panel"><span></span></div></div><div class="pers-wrapper bottom"><div class="stationary-panel"><span></span></div><div class="panel"><span></span></div></div></div>');n.append(q);m[r].push("");q.find("span").css({fontSize:t.fontSize});q.find(".bottom span").css({top:"-"+(t.fontSize/1.5)+"px"});q.find(".panel, .stationary-panel").css({height:t.fontSize/1.5,borderBottomWidth:Math.ceil((t.fontSize/1.5)*0.0322)});if(r===0&&c===0){q.find("span").text("W");d=q.find("span").first().width()}bRadius=(d*0.1);q.find(".top .panel, .top .stationary-panel").css({"-moz-border-radius-topleft":bRadius+"px","-moz-border-radius-topright":bRadius+"px","-webkit-border-radius":bRadius+"px "+bRadius+"px 0 0","border-radius":bRadius+"px "+bRadius+"px 0 0"});q.find(".bottom .panel, .bottom .stationary-panel").css({"-moz-border-radius-bottomleft":bRadius+"px","-moz-border-radius-bottomright":bRadius+"px","-webkit-border-radius":"0 0 "+bRadius+"px "+bRadius+"px","border-radius":"0 0 "+bRadius+"px "+bRadius+"px"});q.find("span").text(" ");q.find("span").css("width",d);q.find("span").css({top:(t.textOffset.v>=0)?"+="+t.textOffset.v+"px":"-="+Math.abs(t.textOffset.v)+"px",left:(t.textOffset.h>=0)?"+="+t.textOffset.h+"px":"-="+Math.abs(t.textOffset.h)+"px"})}}function h(){var v=s.find(".panel-row");var u=[];a.each(v,function(){var w=a(this);var y=w.find(".top .stationary-panel span");var x=[];a.each(y,function(){var z=a(this);x.push(z.text())});u.push(x)});return u}function b(y){var u=t.dimensions[0];var B=t.dimensions[1];var z=[];var w=y.split(" ");var A=0;for(i=0;i<B;i++){var v=u;var C=[];var x=true;while(x){if(_.isString(w[A])&&w[A].length<=v){for(charIndex in w[A]){C.push(w[A][charIndex])}v-=w[A].length;if(v!==0){C.push(" ");v--}A++}else{if(v!==0){C.push(" ");v--}else{x=false}}}z.push(C)}return z}function p(u){var w=s.find(".flipper-container");for(i=0;i<u.length;i++){for(panelIndex in u[i]){var A=a(w[parseInt(panelIndex,10)+(i*m[0].length)]);var x=A.find("span").first().text();var z=u[i][panelIndex];var y=t.alphabet.indexOf(x);var B=t.alphabet.indexOf(z)===-1?0:t.alphabet.indexOf(z);if(t.dimensions[1]>1){var v=i*t.lineDelay;o(A,y,B,v)}else{g(A,y,B)}}}}function o(w,v,x,u){setTimeout(function(){g(w,v,x)},u)}function g(z,x,A){var w=1;if(x===A){w=0}switch(w){case 0:break;case 1:var u=f(x,A,t.alphabet.length);x=t.alphabet[x+1]?x:-1;var v=t.alphabet[x+1];var y=a.Deferred();j(v,z,u,y);a.when(y).then(function(){x++;g(z,x,A)});break}}function j(w,B,y,A){var u=B.find(".top .panel");var v=B.find(".top .stationary-panel span");var x=B.find(".bottom .panel");var z=B.find(".bottom .stationary-panel span");if(y){u.find("span").text(w);x.find("span").text(w);v.text(w);z.text(w);setTimeout(function(){A.resolve()},50)}else{v.text(w);x.children("span").text(w);u.on("webkitAnimationEnd animationend",function(){u.removeClass("topFlipDown");u.children("span").text(w);x.addClass("bottomFlipDown")});x.on("webkitAnimationEnd animationend",function(){x.removeClass("bottomFlipDown");z.text(w);u.off("webkitAnimationEnd animationend");x.off("webkitAnimationEnd animationend");A.resolve()});u.addClass("topFlipDown")}}function f(u,x,v){if(u<x){if(u+t.skipAnimationThreshold>x){return false}else{return true}}else{var w=v-u;if((w+x)>t.skipAnimationThreshold){return true}else{return false}}}function e(x,w){var v={};for(var u in x){if(u in w){if(_.isObject(w[u])&&!_.isArray(w[u])){var y=e(x[u],w[u]);if(!_.isEmpty(y)){v[u]=y}}else{if(!_.isEqual(x[u],w[u])){v[u]=w[u]}}}}return v}var k={updateString:function(x){var v=h();var u=b(x);var w=[];for(i=0;i<v.length;i++){w.push(e(v[i],u[i]))}p(w)},overrideWidth:function(v,u){if(_.isArray(v)){a.each(v,function(){var w;if(_.isString(this)){w=parseInt(this,10)}else{w=this}s.find(".flipper-container").eq(w).find("span").width(u)})}else{if(_.isString(v)){v=parseInt(v,10)}s.find(".flipper-container").eq(v).find("span").width(u)}}};k.updateString(t.text);a.when(this).then(function(){t.callback.apply()});return k}})(jQuery);

//     Underscore.js 1.3.0
//     (c) 2009-2012 Jeremy Ashkenas, DocumentCloud Inc.
//     Underscore is freely distributable under the MIT license.
//     Portions of Underscore are inspired or borrowed from Prototype,
//     Oliver Steele's Functional, and John Resig's Micro-Templating.
//     For all details and documentation:
//     http://documentcloud.github.com/underscore

(function(){function z(a,b,c){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;if(a._chain)a=a._wrapped;if(b._chain)b=b._wrapped;if(a.isEqual&&w.isFunction(a.isEqual))return a.isEqual(b);if(b.isEqual&&w.isFunction(b.isEqual))return b.isEqual(a);var d=i.call(a);if(d!=i.call(b))return false;switch(d){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return false;var e=c.length;while(e--){if(c[e]==a)return true}c.push(a);var f=0,g=true;if(d=="[object Array]"){f=a.length;g=f==b.length;if(g){while(f--){if(!(g=f in a==f in b&&z(a[f],b[f],c)))break}}}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return false;for(var h in a){if(j.call(a,h)){f++;if(!(g=j.call(b,h)&&z(a[h],b[h],c)))break}}if(g){for(h in b){if(j.call(b,h)&&!(f--))break}g=!f}}c.pop();return g}var a=this;var b=a._;var c={};var d=Array.prototype,e=Object.prototype,f=Function.prototype;var g=d.slice,h=d.unshift,i=e.toString,j=e.hasOwnProperty;var k=d.forEach,l=d.map,m=d.reduce,n=d.reduceRight,o=d.filter,p=d.every,q=d.some,r=d.indexOf,s=d.lastIndexOf,t=Array.isArray,u=Object.keys,v=f.bind;var w=function(a){return new A(a)};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=w}exports._=w}else{a["_"]=w}w.VERSION="1.3.0";var x=w.each=w.forEach=function(a,b,d){if(a==null)return;if(k&&a.forEach===k){a.forEach(b,d)}else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++){if(e in a&&b.call(d,a[e],e,a)===c)return}}else{for(var g in a){if(j.call(a,g)){if(b.call(d,a[g],g,a)===c)return}}}};var y=function(){};w.isEqual=function(a,b){return z(a,b,[])};w.isEmpty=function(a){if(w.isArray(a)||w.isString(a))return a.length===0;for(var b in a)if(j.call(a,b))return false;return true};w.isArray=t||function(a){return i.call(a)=="[object Array]"};w.isObject=function(a){return a===Object(a)};w.isFunction=function(a){return i.call(a)=="[object Function]"};w.isString=function(a){return i.call(a)=="[object String]"};var A=function(a){this._wrapped=a};w.prototype=A.prototype;var B=function(a,b){return b?w(a).chain():a};var C=function(a,b){A.prototype[a]=function(){var a=g.call(arguments);h.call(a,this._wrapped);return B(b.apply(w,a),this._chain)}};w.mixin(w);x(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];A.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);var d=c.length;if((a=="shift"||a=="splice")&&d===0)delete c[0];return B(c,this._chain)}});x(["concat","join","slice"],function(a){var b=d[a];A.prototype[a]=function(){return B(b.apply(this._wrapped,arguments),this._chain)}});A.prototype.chain=function(){this._chain=true;return this};A.prototype.value=function(){return this._wrapped}}).call(this)